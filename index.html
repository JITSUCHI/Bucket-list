<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Bucket List（全カテゴリ・自動連番）</title>
  <link rel="stylesheet" href="./style.css?v=23" />
  <style>
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;margin:8px 0 16px}
    .btn{border:1px solid #222;background:#fff;border-radius:6px;padding:6px 10px;cursor:pointer}
    .btn:hover{filter:brightness(0.98)}
    .row{display:flex;gap:8px;align-items:center;margin:10px 0 6px}
    .row input[type="text"]{flex:1;min-width:160px;padding:8px;border:1px solid #cbd5e1;border-radius:6px}
    .row select{padding:7px;border:1px solid #cbd5e1;border-radius:6px}
    .item-actions{display:inline-flex;gap:6px;margin-left:8px;opacity:.7}
    .item-actions button{border:1px solid #cbd5e1;background:#fff;border-radius:6px;padding:2px 6px;cursor:pointer}
    .item-actions button:hover{background:#f1f5f9}
    .editable[contenteditable="true"]{outline:2px dashed #60a5fa; outline-offset:2px; background:#eff6ff}
    .muted{color:#666; font-size:12px}
    nav a{margin-top:8px;display:inline-block;color:#2563eb;text-decoration:none;font-weight:600}
    nav a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <div class="paper">
    <div class="sheet">
      <header class="sheet__header">
        <h1>My Bucket List</h1>
        <p class="legend">
          <span class="legend__red">赤色:達成</span>、
          <span class="legend__blue">青色:進捗あり</span>、
          <span class="legend__green">緑色:継続中</span>
        </p>
        <p class="updated" id="updated">（最終更新日: —）</p>

        <!-- 📊 progress.html へのリンクを追加 -->
        <nav>
          <a href="progress.html">📊 実施状況を見る</a>
        </nav>
      </header>

      <div id="app"></div>

      <p class="muted">※ この版は localStorage に保存します。別端末では JSONエクスポート／インポートを使ってください。</p>
    </div>
  </div>

  <script>
  const KEY = "bucketlist_v4";
 const initialData = {
  updatedAt: new Date().toISOString(),
  categories: [
    { id:"travel", title:"🗺 旅行・冒険", items:[
      { text:"家族で石垣島に行きたい！", status:"todo" },
      { text:"高校の友達とギャンブル旅行に行きたい！", status:"todo" },
    ]},
    { id:"learn", title:"📚 学習・スキル", items:[
      { text:"G検定に合格する。", status:"todo" },
      { text:"E資格に合格する。", status:"todo" },
      { text:"JavaSilverに合格する。", status:"todo" },
      { text:"応用情報技術者試験に合格する。", status:"todo" },
    ]},
    { id:"career", title:"💼 キャリア・お金", items:[
      { text:"結婚したい", status:"todo" },
      { text:"子供を作り子孫を残したい", status:"todo" },
      { text:"岡山の稼働を無事に迎える", status:"todo" },
      { text:"年収1000万の世界を見てみたい（エリートって感じがする）", status:"todo" },
      { text:"手段は問わないから個人で収益が得られるようになりたい", status:"todo" },
      { text:"総資産1000万超えたい", status:"todo" },
      { text:"総資産5000万超えたい", status:"todo" },
      { text:"総資産1億超えたい。", status:"todo" },
      { text:"株式投資の年利益10%を超える（毎年）", status:"todo" },
    ]},
    { id:"life", title:"🏃 健康・ライフスタイル", items:[
      { text:"体重60kg台の景色を見てみたい。", status:"todo" },
      { text:"眉毛サロンデビューする。", status:"todo" },
    ]},
    { id:"hobby", title:"🎨 趣味・体験", items:[
      { text:"海外トナメ（Porker）でインマネしてみたい！", status:"todo" },
      { text:"ラスベガスで旅行代をかけたギャンブルがしたい！", status:"todo" },
      { text:"アミューズメントカジノのトナメで優勝したい！", status:"todo" },
      { text:"阿智村で日本一の星空を堪能したい！", status:"todo" },
      { text:"富士山のふもとでキャンプがしたい！", status:"todo" },
      { text:"キャンプで腰が抜けるほどおいしいごはんを食べたい。", status:"todo" },
      { text:"自分で釣った魚を焼いて食べてみたい。", status:"todo" },
      { text:"一人キャンプをやってみたい。", status:"todo" },
      { text:"「真夏の果実」をピアノで弾けるようになりたい。", status:"todo" },
      { text:"ヨーロッパ旅行に行ってみたい！", status:"todo" },
      { text:"世界で一番発展している場所に行ってみたい（アメリカ）", status:"todo" },
      { text:"6大陸制覇したい！", status:"todo" },
      { text:"たこ焼きの正解をたたき出したい！", status:"todo" },
      { text:"小笠原諸島に行ってみたい！", status:"todo" },
      { text:"グランドキャニオンに行って自然の壮大さを感じたい。", status:"todo" },
      { text:"ドレーク海峡を乗り越えたい。そしてその先の南極大陸へ、、", status:"todo" },
      { text:"地球が丸いことをこの目で確認したい", status:"todo" },
      { text:"富士山に登りたい（済）", status:"done" },
      { text:"家族で石垣島に行きたい！（重複）", status:"todo" },
      { text:"高校の友達とギャンブル旅行に行きたい！（重複）", status:"todo" },
    ]},
    { id:"mind", title:"🌱 精神・教養", items:[
      // 今はまだ空。必要ならここに追加してください！
    ]},
  ]
};

  const statusClass = { done:"done red", progress:"blue", ongoing:"green", todo:"" };

  const load = ()=>JSON.parse(localStorage.getItem(KEY)||"null")||structuredClone(initialData);
  const save = (d)=>{d.updatedAt=new Date().toISOString();localStorage.setItem(KEY,JSON.stringify(d));
    document.getElementById("updated").textContent=`（最終更新日: ${new Date(d.updatedAt).toLocaleString()}）`;
  };

  let state = load();

  const el=(tag,attrs={},...chs)=>{
    const n=document.createElement(tag);
    for(const[k,v] of Object.entries(attrs)){
      if(k==="class") n.className=v;
      else if(k.startsWith("on")) n.addEventListener(k.slice(2),v);
      else n.setAttribute(k,v);
    }
    chs.forEach(c=>n.append(c instanceof Node?c:document.createTextNode(c)));
    return n;
  };

  function render(){
    const app=document.getElementById("app"); app.innerHTML="";
    let counter=1;

    state.categories.forEach(cat=>{
      const details=el("details",{class:"blk",open:true});
      details.append(el("summary",{},el("span",{},cat.title)));

      const addRow = el("div",{class:"row"},
        el("input",{type:"text",placeholder:"項目を追加…",id:`add-${cat.id}`}),
        el("select",{id:`sel-${cat.id}`},
          el("option",{value:"todo"},"未"),
          el("option",{value:"progress"},"進捗"),
          el("option",{value:"ongoing"},"継続"),
          el("option",{value:"done"},"達成"),
        ),
        el("button",{class:"btn",onclick:()=>addItem(cat.id)},"追加")
      );
      details.append(addRow);

      const ol=el("ol",{class:"items"});
      cat.items.forEach((item,idx)=>{
        ol.append(renderItem(cat.id,idx,item,counter));
        counter++;
      });
      details.append(ol);
      app.append(details);
    });
    save(state);
  }

  function renderItem(catId, idx, item, no){
    const li=el("li");
    const span=el("span",{class:`editable ${statusClass[item.status]||""}`,contenteditable:"false"});
    span.textContent=`${no}. ${item.text}`;

    const sel=el("select",{onchange:e=>{
      item.status=e.target.value;
      span.className=`editable ${statusClass[item.status]||""}`;
      save(state); render();
    }},
      el("option",{value:"todo",selected:item.status==="todo"},"未"),
      el("option",{value:"progress",selected:item.status==="progress"},"進捗"),
      el("option",{value:"ongoing",selected:item.status==="ongoing"},"継続"),
      el("option",{value:"done",selected:item.status==="done"},"達成"),
    );

    const actions=el("span",{class:"item-actions"},
      el("button",{onclick:()=>{
        const ed=span.getAttribute("contenteditable")==="true";
        if(ed){span.setAttribute("contenteditable","false"); item.text=span.textContent.replace(/^\d+\.\s*/,"").trim(); save(state);}
        else{span.setAttribute("contenteditable","true");span.focus();}
      }},"✎"),
      el("button",{onclick:()=>moveItem(catId,idx,-1)},"↑"),
      el("button",{onclick:()=>moveItem(catId,idx,1)},"↓"),
      el("button",{onclick:()=>deleteItem(catId,idx)},"🗑"),
    );

    li.append(span," ",sel,actions);
    return li;
  }

  function addItem(catId){
    const input=document.getElementById(`add-${catId}`);
    const sel=document.getElementById(`sel-${catId}`);
    const text=(input.value||"").trim();
    if(!text) return;
    const cat=state.categories.find(c=>c.id===catId);
    cat.items.push({text,status:sel.value});
    input.value="";
    render();
  }

  function deleteItem(catId,idx){
    const cat=state.categories.find(c=>c.id===catId);
    cat.items.splice(idx,1); render();
  }
  function moveItem(catId,idx,d){
    const cat=state.categories.find(c=>c.id===catId);
    const j=idx+d; if(j<0||j>=cat.items.length)return;
    const [it]=cat.items.splice(idx,1); cat.items.splice(j,0,it); render();
  }

  render();
  </script>
</body>
</html>

